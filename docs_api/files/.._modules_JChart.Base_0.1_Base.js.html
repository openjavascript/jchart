<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../modules/JChart.Base/0.1/Base.js - JChart</title>
    <link rel="stylesheet" href="../assets/css/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/widget.css">
    <link rel="stylesheet" href="../assets/css/tabview.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/js/yui-min.js"></script>
    <script src="../assets/js/comps1.js"></script>
    <script src="../assets/js/comps2.js"></script>
    <script src="../assets/js/comps3.js"></script>
    <script src="../assets/js/comps4.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../jc_logo.png" title="JChart"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JC.BaseMVC.html">JC.BaseMVC</a></li>
            
                <li><a href="../classes/JC.BaseMVC.Model.html">JC.BaseMVC.Model</a></li>
            
                <li><a href="../classes/JC.common.html">JC.common</a></li>
            
                <li><a href="../classes/JC.f.html">JC.f</a></li>
            
                <li><a href="../classes/JChart.Base.html">JChart.Base</a></li>
            
                <li><a href="../classes/JChart.Line.html">JChart.Line</a></li>
            
                <li><a href="../classes/window.jQuery.html">window.jQuery</a></li>
            
                <li><a href="../classes/window.requirejs.html">window.requirejs</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../modules/JChart.Base/0.1/Base.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
;(function(define, _win) { &#x27;use strict&#x27;; define( [ &#x27;JChart.Stage&#x27; ], function(){
/**
 * 组件用途简述
 *
 *&lt;p&gt;&lt;b&gt;require&lt;/b&gt;:
 *   &lt;a href=&#x27;JChart.Stage.html&#x27;&gt;JChart.Stage&lt;/a&gt;
 *&lt;/p&gt;
 *
 *&lt;p&gt;&lt;a href=&#x27;https://github.com/openjavascript/jchart&#x27; target=&#x27;_blank&#x27;&gt;JChart Project Site&lt;/a&gt;
 *   | &lt;a href=&#x27;http://jchart.openjavascript.org/docs_api/classes/JChart.Base.html&#x27; target=&#x27;_blank&#x27;&gt;API docs&lt;/a&gt;
 *   | &lt;a href=&#x27;../../modules/JChart.Base/0.1/_demo&#x27; target=&#x27;_blank&#x27;&gt;demo link&lt;/a&gt;&lt;/p&gt;
 *  
 *&lt;h2&gt;页面只要引用本脚本, 默认会处理 div class=&quot;js_compBase&quot;&lt;/h2&gt;
 *
 *&lt;h2&gt;可用的 HTML attribute&lt;/h2&gt;
 *
 *&lt;dl&gt;
 *    &lt;dt&gt;&lt;/dt&gt;
 *    &lt;dd&gt;&lt;dd&gt;
 *&lt;/dl&gt; 
 *
 * @namespace   JChart
 * @class       Base
 * @extends     JC.BaseMVC
 * @constructor
 * @param   {selector|string}   _selector   
 * @version dev 0.1 2014-02-13
 * @author  qiushaowei &lt;suches@btbtd.org&gt; | 75 Team
 * @example
        &lt;h2&gt;JC.Base 示例&lt;/h2&gt;
 */
    var _jdoc = $( document ), _jwin = $( window );

    JChart.Base = Base;

    function Base( _selector ){
        _selector &amp;&amp; ( _selector = $( _selector ) );

        if( JC.BaseMVC.getInstance( _selector, Base ) ) 
            return JC.BaseMVC.getInstance( _selector, Base );

        JC.BaseMVC.getInstance( _selector, Base, this );

        this._model = new Base.Model( _selector );
        this._view = new Base.View( this._model );

        this._init();

        //JC.log( Base.Model._instanceName, &#x27;all inited&#x27;, new Date().getTime() );
    }
    JC.BaseMVC.build( Base );

    var _oldInit = Base.prototype._init;

    JC.f.extendObject( Base.prototype, {
        _init:
            function(){
                _oldInit.call( this );

                this.on( &#x27;update&#x27;, function( _evt, _data ){
                    this._view.update( _data );
                });

                this._initData();
            }

        , _beforeInit:
            function(){
            }

        , _initHanlderEvent:
            function(){
            }

        , _inited:
            function(){
                _p._initData();
            }

        , _initData:
            function(){

                var _data;

                if( this.selector().attr( &#x27;chartScriptData&#x27; ) ){
                    _data = JC.f.scriptContent( this._model.selectorProp( &#x27;chartScriptData&#x27; ) );
                    _data = eval( &#x27;(&#x27; + _data + &#x27;)&#x27; );
                    this.trigger( &#x27;update&#x27;, [ _data ] );
                }

                return this;
            }
    });

    Base.Model._instanceName = &#x27;JChartBase&#x27;;
    JC.f.extendObject( Base.Model.prototype, {
        init:
            function(){
                //JC.log( &#x27;Base.Model.init:&#x27;, new Date().getTime() );
            }

        , width:
            function(){
                var _r = this.selector().prop( &#x27;offsetWidth&#x27; );
                this.is( &#x27;[chartWidth]&#x27; ) &amp;&amp; ( _r = this.intProp( &#x27;chartWidth&#x27; ) || _r );
                return _r;
            }

        , height:
            function(){
                var _r = this.selector().prop( &#x27;offsetHeight&#x27; );
                this.is( &#x27;[chartHeight]&#x27; ) &amp;&amp; ( _r = this.intProp( &#x27;chartHeight&#x27; ) || _r );
                return _r;
            }

        , stage:
            function(){

                if( !this._stage ){
                    this._stage = new JChart.Stage( this.width(), this.height(), true );
                    this._stage.selector().appendTo( this.selector() );
                    this._stage.roundedRect( 0, 0, this.width(), this.height() );
                }

                return this._stage;
            }
        
        , data:
            function( _data ){
                typeof _data != &#x27;undefined&#x27; &amp;&amp; ( this._data = _data );
                return this._data;
            }

        , clear: function(){}

        , htitle:
            function( _setter ){
                if( typeof _setter != &#x27;undefined&#x27; ){
                    this._htitle &amp;&amp; this._htitle.remove();
                    this._htitle =  _setter;
                    this.stage().add( _setter );
                    _setter.selector().appendTo( this.selector() );
                }
                return this._htitle;
            }

        , vtitle:
            function( _setter ){
                if( typeof _setter != &#x27;undefined&#x27; ){
                    this._vtitle &amp;&amp; this._vtitle.remove();
                    this._vtitle =  _setter;
                    this.stage().add( _setter );
                    _setter.selector().appendTo( this.selector() );
                }
                return this._vtitle;
            }
    });

    JC.f.extendObject( Base.View.prototype, {
        init:
            function(){
                //JC.log( &#x27;Base.View.init:&#x27;, new Date().getTime() );
            }

        , width: function(){ return this._model.width(); }
        , height: function(){ return this._model.height(); }

        , selector:
            function(){
                return this._model.selector();
            }

        , clear: 
            function(){
                this.selector().find( &#x27;canvas&#x27; ).remove();
            }

        , update: 
            function( _data ){
                this.clear();
                this._model.clear();
                this._model.data( _data );
                this.draw( _data );
            }

        , draw: 
            function( _data ){
            }

        , drawCTitle:
            function( _title, _font ){
                if( !_title ) return;
                !_font &amp;&amp; ( _font = &#x27;16px sans-serif&#x27; );
                var _htitle = new JChart.Stage( this.width(), this.height() )
                    , _textSize = _htitle.textSize( _title, _font )
                    , _x = this.width() / 2 - _textSize.width / 2
                    , _y = _textSize.height + 10
                    ;

                //JC.log( &#x27;width:&#x27;, _textSize.width, &#x27;height:&#x27;, _textSize.height, _htitle.context().font );

                this._model.htitle( _htitle );
                this._model.htitle().context().fillText( _title, _x, _y );
                this._model.htitle().graphicRect( _x, _y, _textSize.width, _textSize.height );
            }

        , drawVTitle:
            function( _title, _font ){
                if( !_title ) return;
                !_font &amp;&amp; ( _font = &#x27;16px 宋体&#x27; );
                var _vtitle = new JChart.Stage( this.width(), this.height() )
                    , _textSize = _vtitle.textSize( _title, _font )
                    , _x = 0
                    , _offsetY = 5
                    , _y = _textSize.height + _offsetY
                    ;

                _vtitle.context().translate( _x, _textSize.width + ( this.height() - _textSize.width ) / 2 );
                _vtitle.rotate( -90 );
                this._model.vtitle( _vtitle );
                _vtitle.context().fillText( _title, _x, _y );
                _vtitle.graphicRect( _x, _y, _textSize.width, _textSize.height );

            }
    });

    return JChart.Base;
});}( typeof define === &#x27;function&#x27; &amp;&amp; define.amd ? define : 
        function ( _name, _require, _cb ) { 
            typeof _name == &#x27;function&#x27; &amp;&amp; ( _cb = _name );
            typeof _require == &#x27;function&#x27; &amp;&amp; ( _cb = _require ); 
            _cb &amp;&amp; _cb(); 
        }
        , window
    )
);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
