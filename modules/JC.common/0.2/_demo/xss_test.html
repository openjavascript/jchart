<!doctype html>
<html>
<head>
<meta charset=utf-8 />
<title>Open JQuery Components Library - suches</title>
    <style>
        body{
            margin: 20px 40px;
        }

        .ipt,.txt,.txt-1{ border:1px solid #e2e3ea; border-top:1px solid #abadb3; border-radius:2px; height:22px; *line-height:22px;}
        .ipt{ width:126px;}
        .ipt-w58{ width:58px;}
        .ipt-w48{ width:48px; text-align:center;}
        .ipt-w80{ width:80px;}
        .ipt-w180{ width:180px;}
        .ipt-w230{ width: 230px;}
        .ipt-w320{ width:320px;}
        .ipt-w380{ width:380px;}
        .ipt-w480{ width:480px;}
        .ipt-w545{ width:545px;}
        .txt,.txt-1{ resize:none; height:50px; width:99.8%;}
        .txt-w280{ width:280px;}
        .txt-w480{ width:480px;}
        .txt-w545{ width:545px;}
        .txt-w400{ width:410px;}
        .txt-w380{ width:380px;}
        .txt-w650{ width:650px;}

        .defDl > dd{
            border-bottom:1px solid #e2e3ea; 
        }

        th{ text-align: left; }
    </style>
    <link href='../../../../modules/JC.Valid/0.2/res/default/style.css' rel='stylesheet' />

    <script src="../../../../lib.js"></script>
    <script src="../../../../config.js"></script>
    <script>
        JC.debug = true;

        requirejs( [ 'JC.Valid' ], function(){
            $( document ).delegate( 'button.js_test', 'click', function( _evt ){
                var _p = $(this)
                    , _txas = JC.f.parentSelector( _p, '(table textarea'  )
                    , _testCode, _r
                    ;

                _testCode = _txas.first().val().trim();
                if( !_testCode ) return;

                eval( '( _r =' + _testCode + ' )' );
                _txas.last().val( _r );
            });

            $( 'button.js_test' ).each( function( _evt ){
                $(this).trigger( 'click' );
            });
        });
    </script>
</head>    
<body>
    <h2>JC.common XSS 测试</h2>

    <dl class="defDl">
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.addUrlParams
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.addUrlParams( 'baidu.com?export="><script>alert(/xss/)</script>', { "param": 1 } )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.addUrlParams
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.addUrlParams( 'baidu.com?export=test', { "param": 1 } )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>

        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.getUrlParam
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.getUrlParam( 'baidu.com?export="><script>alert(/xss/)</script>', 'export' )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.getUrlParams
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.getUrlParams( 'baidu.com?export="><script>alert(/xss/)</script>&export=normal', 'export' )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.delUrlParam
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.delUrlParam( 'baidu.com?export="><script>alert(/xss/)</script>&test=normal', 'test' )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.reloadPage
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.reloadPage( 'baidu.com?export="><script>alert(/xss/)</script>&test=normal', null, 1111111111 )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.urlDetect
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.urlDetect( 'baidu.com?export="><script>alert(/xss/)</script>&test=normal' )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>
        <dd>
            <table>
                <tr>
                    <th colspan="4">
                        JC.f.removeUrlSharp
                        <button type="button" class="js_test">run</button>
                    </th>
                </tr>
                <tr>
                    <td>test code: </td>
                    <td>
<textarea class="txt txt-w400">
    JC.f.removeUrlSharp( 'baidu.com?export="><script>alert(/xss/)</script>&test=normal#anchor' )
</textarea>
                    </td>
                    <td>result: </td>
                    <td>
                        <textarea class="txt txt-w400"></textarea>
                    </td>
                </tr>
            </table>
        </dd>

    </dl>
</body>
</html>


